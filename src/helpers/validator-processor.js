const User = require("../models/user");
const { body } = require("express-validator");
const { parseISO, isPast } = require("date-fns");
const { validateLatLngFormat } = require("../Middleware/validation");

const idExpiryDateValidator = (value) => {
	const date = parseISO(value); // Parse the date string into a Date object
	const currentDate = new Date(); // Get the current date
	if (isPast(date)) {
		throw new Error("ID expiry date must not be in the past.");
	}
	return true;
};

const validIso3CountryCodes = [
	"AFG",
	"ALA",
	"ALB",
	"DZA",
	"ASM",
	"AND",
	"AGO",
	"AIA",
	"ATA",
	"ATG",
	"ARG",
	"ARM",
	"ABW",
	"AUS",
	"AUT",
	"AZE",
	"BHS",
	"BHR",
	"BGD",
	"BRB",
	"BLR",
	"BEL",
	"BLZ",
	"BEN",
	"BMU",
	"BTN",
	"BOL",
	"BES",
	"BIH",
	"BWA",
	"BVT",
	"BRA",
	"IOT",
	"BRN",
	"BGR",
	"BFA",
	"BDI",
	"CPV",
	"KHM",
	"CMR",
	"CAN",
	"CYM",
	"CAF",
	"TCD",
	"CHL",
	"CHN",
	"CXR",
	"CCK",
	"COL",
	"COM",
	"COG",
	"COD",
	"COK",
	"CRI",
	"CIV",
	"HRV",
	"CUB",
	"CUW",
	"CYP",
	"CZE",
	"DNK",
	"DJI",
	"DMA",
	"DOM",
	"ECU",
	"EGY",
	"SLV",
	"GNQ",
	"ERI",
	"EST",
	"ETH",
	"FLK",
	"FRO",
	"FJI",
	"FIN",
	"FRA",
	"GUF",
	"PYF",
	"ATF",
	"GAB",
	"GMB",
	"GEO",
	"DEU",
	"GHA",
	"GIB",
	"GRC",
	"GRL",
	"GRD",
	"GLP",
	"GUM",
	"GTM",
	"GGY",
	"GIN",
	"GNB",
	"GUY",
	"HTI",
	"HMD",
	"VAT",
	"HND",
	"HKG",
	"HUN",
	"ISL",
	"IND",
	"IDN",
	"IRN",
	"IRQ",
	"IRL",
	"IMN",
	"ISR",
	"ITA",
	"JAM",
	"JPN",
	"JEY",
	"JOR",
	"KAZ",
	"KEN",
	"KIR",
	"PRK",
	"KOR",
	"KWT",
	"KGZ",
	"LAO",
	"LVA",
	"LBN",
	"LSO",
	"LBR",
	"LBY",
	"LIE",
	"LTU",
	"LUX",
	"MAC",
	"MKD",
	"MDG",
	"MWI",
	"MYS",
	"MDV",
	"MLI",
	"MLT",
	"MHL",
	"MTQ",
	"MRT",
	"MUS",
	"MYT",
	"MEX",
	"FSM",
	"MDA",
	"MCO",
	"MNG",
	"MNE",
	"MSR",
	"MAR",
	"MOZ",
	"MMR",
	"NAM",
	"NRU",
	"NPL",
	"NLD",
	"NCL",
	"NZL",
	"NIC",
	"NER",
	"NGA",
	"NIU",
	"NFK",
	"MNP",
	"NOR",
	"OMN",
	"PAK",
	"PLW",
	"PSE",
	"PAN",
	"PNG",
	"PRY",
	"PER",
	"PHL",
	"PCN",
	"POL",
	"PRT",
	"PRI",
	"QAT",
	"REU",
	"ROU",
	"RUS",
	"RWA",
	"BLM",
	"SHN",
	"KNA",
	"LCA",
	"MAF",
	"SPM",
	"VCT",
	"WSM",
	"SMR",
	"STP",
	"SAU",
	"SEN",
	"SRB",
	"SYC",
	"SLE",
	"SGP",
	"SXM",
	"SVK",
	"SVN",
	"SLB",
	"SOM",
	"ZAF",
	"SGS",
	"SSD",
	"ESP",
	"LKA",
	"SDN",
	"SUR",
	"SJM",
	"SWZ",
	"SWE",
	"CHE",
	"SYR",
	"TWN",
	"TJK",
	"TZA",
	"THA",
	"TLS",
	"TGO",
	"TKL",
	"TON",
	"TTO",
	"TUN",
	"TUR",
	"TKM",
	"TCA",
	"TUV",
	"UGA",
	"UKR",
	"ARE",
	"GBR",
	"USA",
	"UMI",
	"URY",
	"UZB",
	"VUT",
	"VEN",
	"VNM",
	"VGB",
	"VIR",
	"WLF",
	"ESH",
	"YEM",
	"ZMB",
	"ZWE",
];

const isValidIso3CountryCode = (value) => {
	return validIso3CountryCodes.includes(value.toUpperCase());
};

const validateCountryISO3Code = [
	body("countryIso3Code")
		.exists()
		.withMessage("Country is required")
		.isLength({ min: 3, max: 3 })
		.withMessage("Country must be 3 characters")
		.custom(isValidIso3CountryCode)
		.withMessage("Invalid ISO 3166-1 alpha-3 country code"),
	body("country").notEmpty().isString().withMessage("Counry is required."),
];

const validateHelpDesk = [
	body("title").notEmpty().isString().withMessage("Title is required."),
	body("category").notEmpty().isString().withMessage("Category is required."),
	body("content").notEmpty().isString().withMessage("Content is required."),
];

const validateNewsRoom = [
	body("title").notEmpty().isString().withMessage("Title is required."),
	body("image").notEmpty().isString().withMessage("Image is required."),
	body("excerpt").notEmpty().isString().withMessage("Excerpt is required."),
	body("content").notEmpty().isString().withMessage("Content is required."),
];

const validateSignUpWithEmail = [
	body("firstName")
		.notEmpty()
		.isString()
		.withMessage("First name is required."),
	body("lastName").notEmpty().isString().withMessage("Last name is required."),
	body("email")
		.notEmpty()
		.isString()
		.isEmail()
		.withMessage("Email is required is required."),
	body("phoneNumber")
		.notEmpty()
		.isString()
		.withMessage("Phone number is required."),
	body("password")
		.isLength({ min: 8, max: 30 })
		.withMessage("Password must be minimum 8 characters"),
];

module.exports = {
	validateHelpDesk,
	validateNewsRoom,
	validateSignUpWithEmail,
};
